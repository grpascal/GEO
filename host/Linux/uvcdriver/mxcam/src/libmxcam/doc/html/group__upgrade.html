<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libmxcam: Upgrade firmware</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Upgrade firmware</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfw__info.html">fw_info</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">structure to encapsulate firmware upgrade information that used in <a class="el" href="group__upgrade.html#gaebc0144ed43fd9f5cb647732d11c1200">mxcam_upgrade_firmware</a> function  <a href="structfw__info.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga20fc3c3b541b7829645f4fb87181f10f"></a><!-- doxytag: member="upgrade::fw_info" ref="ga20fc3c3b541b7829645f4fb87181f10f" args="" -->
typedef struct <a class="el" href="structfw__info.html">fw_info</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__upgrade.html#ga20fc3c3b541b7829645f4fb87181f10f">fw_info</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">structure to encapsulate firmware upgrade information that used in <a class="el" href="group__upgrade.html#gaebc0144ed43fd9f5cb647732d11c1200">mxcam_upgrade_firmware</a> function <br/></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__upgrade.html#ga141ef22394eaf227843063bb29c2cee5">PGM_MEDIA</a> { <a class="el" href="group__upgrade.html#gga141ef22394eaf227843063bb29c2cee5a51574cc2a0ce85c0cc496d5510e2e279">EEPROM</a> = 0x1, 
<a class="el" href="group__upgrade.html#gga141ef22394eaf227843063bb29c2cee5ab079ff9241ff8d5dadeb0f708ec5b6ef">PNOR</a>, 
<a class="el" href="group__upgrade.html#gga141ef22394eaf227843063bb29c2cee5a001e2348d9146b2adf5b5eb54ce4eb9c">SNOR</a>, 
<a class="el" href="group__upgrade.html#gga141ef22394eaf227843063bb29c2cee5a01792380162acc0a7009d281bd8e4dc3">LAST_MEDIA</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>program media used for firmware upgrade </p>
 <a href="group__upgrade.html#ga141ef22394eaf227843063bb29c2cee5">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__upgrade.html#ga044a24139d19162b04f0bcb959016a26">BOOTMODE</a> { <a class="el" href="group__upgrade.html#gga044a24139d19162b04f0bcb959016a26a55c50be59001f12b54c48b09e434dced">MODE_NONE</a> =  0, 
<a class="el" href="group__upgrade.html#gga044a24139d19162b04f0bcb959016a26a51c9c4a97cba7ee7bf95a4be73c80404">MODE_USB</a>, 
<a class="el" href="group__upgrade.html#gga044a24139d19162b04f0bcb959016a26a7f42a95318058ee72d27ae7b34f2d752">MODE_SNOR</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>represents BOOTMODE used in <a class="el" href="group__upgrade.html#gaebc0144ed43fd9f5cb647732d11c1200">mxcam_upgrade_firmware</a> function </p>
 <a href="group__upgrade.html#ga044a24139d19162b04f0bcb959016a26">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__upgrade.html#gaebc0144ed43fd9f5cb647732d11c1200">mxcam_upgrade_firmware</a> (<a class="el" href="structfw__info.html">fw_info</a> *fw, void(*callbk)(<a class="el" href="group__boot.html#gac729d2bc7e8a3dea825ba612a2c94450">FW_STATE</a> st, char *filename), int is_rom_img)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mxcam_upgrade_firmware: upgrade the camera firmware  <a href="#gaebc0144ed43fd9f5cb647732d11c1200"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__upgrade.html#ga2cc61197bdd606595bc54972b2808613">mxcam_read_nvm_pgm_status</a> (unsigned char *status)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mxcam_read_nvm_pgm_status: get non volatile memory progamming status  <a href="#ga2cc61197bdd606595bc54972b2808613"></a><br/></td></tr>
</table>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga141ef22394eaf227843063bb29c2cee5"></a><!-- doxytag: member="libmxcam.h::PGM_MEDIA" ref="ga141ef22394eaf227843063bb29c2cee5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__upgrade.html#ga141ef22394eaf227843063bb29c2cee5">PGM_MEDIA</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>program media used for firmware upgrade </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga141ef22394eaf227843063bb29c2cee5a51574cc2a0ce85c0cc496d5510e2e279"></a><!-- doxytag: member="EEPROM" ref="gga141ef22394eaf227843063bb29c2cee5a51574cc2a0ce85c0cc496d5510e2e279" args="" -->EEPROM</em>&nbsp;</td><td>
<p>firmware upgrade media is EEPROM </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga141ef22394eaf227843063bb29c2cee5ab079ff9241ff8d5dadeb0f708ec5b6ef"></a><!-- doxytag: member="PNOR" ref="gga141ef22394eaf227843063bb29c2cee5ab079ff9241ff8d5dadeb0f708ec5b6ef" args="" -->PNOR</em>&nbsp;</td><td>
<p>firmware upgrade media is parallel NOR </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga141ef22394eaf227843063bb29c2cee5a001e2348d9146b2adf5b5eb54ce4eb9c"></a><!-- doxytag: member="SNOR" ref="gga141ef22394eaf227843063bb29c2cee5a001e2348d9146b2adf5b5eb54ce4eb9c" args="" -->SNOR</em>&nbsp;</td><td>
<p>firmware upgrade media is serial NOR </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga141ef22394eaf227843063bb29c2cee5a01792380162acc0a7009d281bd8e4dc3"></a><!-- doxytag: member="LAST_MEDIA" ref="gga141ef22394eaf227843063bb29c2cee5a01792380162acc0a7009d281bd8e4dc3" args="" -->LAST_MEDIA</em>&nbsp;</td><td>
<p>max upgrade media for validation </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga044a24139d19162b04f0bcb959016a26"></a><!-- doxytag: member="libmxcam.h::BOOTMODE" ref="ga044a24139d19162b04f0bcb959016a26" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__upgrade.html#ga044a24139d19162b04f0bcb959016a26">BOOTMODE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>represents BOOTMODE used in <a class="el" href="group__upgrade.html#gaebc0144ed43fd9f5cb647732d11c1200">mxcam_upgrade_firmware</a> function </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga044a24139d19162b04f0bcb959016a26a55c50be59001f12b54c48b09e434dced"></a><!-- doxytag: member="MODE_NONE" ref="gga044a24139d19162b04f0bcb959016a26a55c50be59001f12b54c48b09e434dced" args="" -->MODE_NONE</em>&nbsp;</td><td>
<p>don't set the bootmode of bootloader </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga044a24139d19162b04f0bcb959016a26a51c9c4a97cba7ee7bf95a4be73c80404"></a><!-- doxytag: member="MODE_USB" ref="gga044a24139d19162b04f0bcb959016a26a51c9c4a97cba7ee7bf95a4be73c80404" args="" -->MODE_USB</em>&nbsp;</td><td>
<p>set the bootmode as USB </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga044a24139d19162b04f0bcb959016a26a7f42a95318058ee72d27ae7b34f2d752"></a><!-- doxytag: member="MODE_SNOR" ref="gga044a24139d19162b04f0bcb959016a26a7f42a95318058ee72d27ae7b34f2d752" args="" -->MODE_SNOR</em>&nbsp;</td><td>
<p>set the bootmode as serial nor </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaebc0144ed43fd9f5cb647732d11c1200"></a><!-- doxytag: member="libmxcam.c::mxcam_upgrade_firmware" ref="gaebc0144ed43fd9f5cb647732d11c1200" args="(fw_info *fw, void(*callbk)(FW_STATE st, char *filename), int is_rom_img)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mxcam_upgrade_firmware </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfw__info.html">fw_info</a> *&nbsp;</td>
          <td class="paramname"> <em>fw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="group__boot.html#gac729d2bc7e8a3dea825ba612a2c94450">FW_STATE</a> st, char *filename)&nbsp;</td>
          <td class="paramname"> <em>callbk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>is_rom_img</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>mxcam_upgrade_firmware: upgrade the camera firmware </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*fw</em>&nbsp;</td><td>:pointer to a structure that encapsulate fw upgrade information </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>*callbk</em>&nbsp;</td><td>:register the callbk function pointer here, _callbk_ will be invoked before and after the file transfer over usb </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_rom_img</em>&nbsp;</td><td>: true if the image is a rom image</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_INVALID_PARAM</em>&nbsp;</td><td>- if any one of the following condition meet</p>
<ul>
<li>devhandle is NULL</li>
<li>fw is NULL</li>
<li>fw-&gt;image anf fw-&gt;bootldr are NULL</li>
<li>fw-&gt;img_media &gt;= LAST_MEDIA</li>
<li>fw-&gt;bootldr_media &gt;= LAST_MEDIA</li>
<li>callbk is NULL </li>
</ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_IMAGE_SEND_FAILED</em>&nbsp;</td><td>- if send fails </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_FW_IMAGE_CORRUPTED</em>&nbsp;</td><td>- found an corrupted image at camera </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_FW_UNSUPPORTED_FLASH_MEMORY</em>&nbsp;</td><td>- found unsupported flash memory </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Negativevalue</em>&nbsp;</td><td>- upon libusb error </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_OK</em>&nbsp;</td><td>- upon success</td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>upgrade the camera with the image information given in <a class="el" href="structfw__info.html" title="structure to encapsulate firmware upgrade information that used in mxcam_upgrade_firmware function...">fw_info</a> structure.<br/>
 using this function you can upgrade application image and/or bootloader image on given program media provied in <a class="el" href="structfw__info.html" title="structure to encapsulate firmware upgrade information that used in mxcam_upgrade_firmware function...">fw_info</a>. <br/>
 as a status, callbk will invoked before and after the file transfer over usb with FW_STATE. </dd></dl>

</div>
</div>
<a class="anchor" id="ga2cc61197bdd606595bc54972b2808613"></a><!-- doxytag: member="libmxcam.c::mxcam_read_nvm_pgm_status" ref="ga2cc61197bdd606595bc54972b2808613" args="(unsigned char *status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mxcam_read_nvm_pgm_status </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>status</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>mxcam_read_nvm_pgm_status: get non volatile memory progamming status </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*status</em>&nbsp;</td><td>:unsigned char pointer to retrieve programming status information </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_INVALID_PARAM</em>&nbsp;</td><td>- if any one of the following condition meet</p>
<ul>
<li>devhandle is NULL</li>
<li>status is NULL </li>
</ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Negativevalue</em>&nbsp;</td><td>- upon libusb error </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_FW_SNOR_FAILED</em>&nbsp;</td><td>- when firmware image upgrade fails </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_FAIL</em>&nbsp;</td><td>- when an unknown error returns from skypecam </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_ERR_FW_IMAGE_CORRUPTED</em>&nbsp;</td><td>- if the image sent to skypecam is corrupted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MXCAM_OK</em>&nbsp;</td><td>- upon success</td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>get non volatile memory programming status see <a class="el" href="group__misc.html#gacd0afdda681ee589d50e106db655af48">MXCAM_STAT_ERR</a> </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
